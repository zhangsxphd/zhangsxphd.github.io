<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="zh-CN"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;上海市灌溉数据填报系统&lt;/title&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 1. 引入 Tailwind CSS (样式库) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 2. 定义依赖包映射 (使用 esm.sh CDN) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="importmap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>"imports": {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"react": "https://esm.sh/react@18.2.0",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"react-dom/client": "https://esm.sh/react-dom@18.2.0/client",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"lucide-react": "https://esm.sh/lucide-react@0.263.1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 3. 引入 Babel (用于在浏览器中解析 JSX) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://unpkg.com/@babel/standalone/babel.min.js"&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 4. 引入 LeanCloud SDK --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"&gt;&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* 自定义滚动条样式 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.custom-scrollbar::-webkit-scrollbar { width: 6px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.custom-scrollbar::-webkit-scrollbar-thumb { background: #c7c7c7; border-radius: 3px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* 加载动画 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.loading-spinner {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 4px solid #f3f3f3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-top: 4px solid #3498db;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-radius: 50%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>height: 40px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>animation: spin 1s linear infinite;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 20px auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body class="bg-slate-100"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="root"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- 初始化加载界面，防止白屏 --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div style="height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #64748b;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="loading-spinner"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;h2 style="font-size: 1.2rem; font-weight: bold;"&gt;系统正在加载中...&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;p style="font-size: 0.9rem; margin-top: 10px;"&gt;如果是本地直接打开 (file://)，请注意可能会因为 CORS 策略无法运行。&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;p style="font-size: 0.9rem;"&gt;请上传至 GitHub Pages 或在本地服务器运行。&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 错误捕获脚本 --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener('error', function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e.message.includes('Access-Control-Allow-Origin') || e.message.includes('module')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const root = document.getElementById('root');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>root.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div style="padding: 20px; text-align: center; color: #ef4444; margin-top: 50px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h1 style="font-size: 24px; font-weight: bold;"&gt;无法在本地直接运行&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p style="margin-top: 10px;"&gt;检测到跨域(CORS)错误。这是因为你可能双击了 HTML 文件直接打开。&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div style="background: #fff; padding: 20px; border-radius: 10px; margin-top: 20px; display: inline-block; text-align: left; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p&gt;&lt;strong&gt;解决方法：&lt;/strong&gt;&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ol style="list-style: decimal; margin-left: 20px; margin-top: 10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;li&gt;将此文件上传到 &lt;strong&gt;GitHub Pages&lt;/strong&gt; (你的 zhangsxphd.github.io)。&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;li&gt;或者在本地安装 VS Code 插件 "Live Server" 并通过它打开。&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- 5. 应用程序逻辑 --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script type="text/babel" data-type="module"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import React, { useState, useMemo, useEffect } from 'react';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import { createRoot } from 'react-dom/client';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>import {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>ClipboardEdit, Save, Calendar, Droplets, Layers, Calculator, X, History,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>MapPin, Ruler, AlertCircle, AlertTriangle, Pencil, MousePointerClick,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>ChevronDown, ChevronUp, CornerDownRight, Check, Trash2, Plus, Hash,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Loader2, Cloud, CheckSquare, Square, Wifi, WifiOff, BrainCircuit,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>Sparkles, LayoutDashboard, Sprout, Bot, BarChart3</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>} from 'lucide-react';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// LeanCloud 配置信息</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const LEANCLOUD_APP_ID = "gUdUKvrJuhv7duj8gpe5FM3w-MdYXbMMI";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const LEANCLOUD_APP_KEY = "0XDb3n3bypxVr46iXKTRWcUV";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const LEANCLOUD_SERVER_URL = "https://gudukvrj.api.lncldglobal.com";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const apiKey = "";<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const STATIC_ZONES_DEF = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 1, name: "崇明区", location: "崇明区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 2, name: "青浦区", location: "青浦区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 3, name: "松江区", location: "松江区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 4, name: "浦东新区", location: "浦东新区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 5, name: "宝山区", location: "宝山区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 6, name: "奉贤区", location: "奉贤区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ id: 7, name: "闵行区", location: "闵行区" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const SEED_POINTS = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "城桥镇样点灌区" }, { zoneId: 1, name: "堡镇样点灌区" }, { zoneId: 1, name: "新河镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "庙镇样点灌区" }, { zoneId: 1, name: "竖新镇样点灌区" }, { zoneId: 1, name: "向化镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "三星镇样点灌区" }, { zoneId: 1, name: "港沿镇样点灌区" }, { zoneId: 1, name: "中兴镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "陈家镇样点灌区" }, { zoneId: 1, name: "绿华镇样点灌区" }, { zoneId: 1, name: "港西镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "建设镇样点灌区" }, { zoneId: 1, name: "新海镇样点灌区" }, { zoneId: 1, name: "东平镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 1, name: "长兴镇样点灌区" }, { zoneId: 1, name: "横沙乡样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 2, name: "赵巷镇样点灌区" }, { zoneId: 2, name: "徐泾镇样点灌区" }, { zoneId: 2, name: "华新镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 2, name: "重固镇样点灌区" }, { zoneId: 2, name: "白鹤镇样点灌区" }, { zoneId: 2, name: "朱家角镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 2, name: "练塘镇样点灌区" }, { zoneId: 2, name: "金泽镇样点灌区" }, { zoneId: 2, name: "夏阳街道样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 2, name: "盈浦街道样点灌区" }, { zoneId: 2, name: "香花桥街道样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 3, name: "泗泾镇样点灌区" }, { zoneId: 3, name: "佘山镇样点灌区" }, { zoneId: 3, name: "车墩镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 3, name: "新桥镇样点灌区" }, { zoneId: 3, name: "洞泾镇样点灌区" }, { zoneId: 3, name: "九亭镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 3, name: "泖港镇样点灌区" }, { zoneId: 3, name: "石湖荡镇样点灌区" }, { zoneId: 3, name: "新浜镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 3, name: "叶榭镇样点灌区" }, { zoneId: 3, name: "小昆山镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "川沙新镇样点灌区" }, { zoneId: 4, name: "祝桥镇样点灌区" }, { zoneId: 4, name: "金桥镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "曹路镇样点灌区" }, { zoneId: 4, name: "张江镇样点灌区" }, { zoneId: 4, name: "合庆镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "唐镇样点灌区" }, { zoneId: 4, name: "高桥镇样点灌区" }, { zoneId: 4, name: "高东镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "高行镇样点灌区" }, { zoneId: 4, name: "三林镇样点灌区" }, { zoneId: 4, name: "北蔡镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "康桥镇样点灌区" }, { zoneId: 4, name: "周浦镇样点灌区" }, { zoneId: 4, name: "航头镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "新场镇样点灌区" }, { zoneId: 4, name: "宣桥镇样点灌区" }, { zoneId: 4, name: "惠南镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "大团镇样点灌区" }, { zoneId: 4, name: "老港镇样点灌区" }, { zoneId: 4, name: "万祥镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 4, name: "书院镇样点灌区" }, { zoneId: 4, name: "泥城镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 5, name: "罗店镇样点灌区" }, { zoneId: 5, name: "大场镇样点灌区" }, { zoneId: 5, name: "杨行镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 5, name: "月浦镇样点灌区" }, { zoneId: 5, name: "罗泾镇样点灌区" }, { zoneId: 5, name: "顾村镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 5, name: "高境镇样点灌区" }, { zoneId: 5, name: "庙行镇样点灌区" }, { zoneId: 5, name: "淞南镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 6, name: "南桥镇样点灌区" }, { zoneId: 6, name: "奉城镇样点灌区" }, { zoneId: 6, name: "庄行镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 6, name: "金汇镇样点灌区" }, { zoneId: 6, name: "四团镇样点灌区" }, { zoneId: 6, name: "青村镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 6, name: "柘林镇样点灌区" }, { zoneId: 6, name: "海湾镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 7, name: "莘庄镇样点灌区" }, { zoneId: 7, name: "七宝镇样点灌区" }, { zoneId: 7, name: "颛桥镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 7, name: "华漕镇样点灌区" }, { zoneId: 7, name: "虹桥镇样点灌区" }, { zoneId: 7, name: "梅陇镇样点灌区" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>{ zoneId: 7, name: "吴泾镇样点灌区" }, { zoneId: 7, name: "马桥镇样点灌区" }, { zoneId: 7, name: "浦江镇样点灌区" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function App() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [zones, setZones] = useState(STATIC_ZONES_DEF.map(z =&gt; ({ ...z, points: [] })));<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [records, setRecords] = useState([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [isSdkReady, setIsSdkReady] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [isLoading, setIsLoading] = useState(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [loadingMessage, setLoadingMessage] = useState("正在连接服务器...");</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [selectedZone, setSelectedZone] = useState(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [selectedPoint, setSelectedPoint] = useState(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [expandedZoneId, setExpandedZoneId] = useState(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [filterZoneId, setFilterZoneId] = useState(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [isModalOpen, setIsModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [editingRecordId, setEditingRecordId] = useState(null);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [deleteModalOpen, setDeleteModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [deleteType, setDeleteType] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [itemToDelete, setItemToDelete] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [selectedRecordIds, setSelectedRecordIds] = useState([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [editingPointId, setEditingPointId] = useState(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [editNameValue, setEditNameValue] = useState("");<span class="Apple-converted-space">     </span></span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [currentTime, setCurrentTime] = useState(new Date());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [isOnline, setIsOnline] = useState(navigator.onLine);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [aiModalOpen, setAiModalOpen] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [aiAnalysisResult, setAiAnalysisResult] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [isGeminiAnalyzing, setIsGeminiAnalyzing] = useState(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [geminiGlobalResult, setGeminiGlobalResult] = useState(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [geminiGlobalModalOpen, setGeminiGlobalModalOpen] = useState(false);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const [formData, setFormData] = useState({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>date: new Date().toISOString().split('T')[0],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>fieldNumber: '1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>moistureBefore: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>moistureAfter: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>depth: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>waterDepthBefore: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>waterDepthAfter: ''</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const timer = setInterval(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setCurrentTime(new Date());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, 1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return () =&gt; clearInterval(timer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, []);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleOnline = () =&gt; setIsOnline(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const handleOffline = () =&gt; setIsOnline(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.addEventListener('online', handleOnline);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.addEventListener('offline', handleOffline);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>window.removeEventListener('online', handleOnline);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>window.removeEventListener('offline', handleOffline);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, []);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (window.AV) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if (!window.AV.applicationId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>window.AV.init({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>appId: LEANCLOUD_APP_ID,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>appKey: LEANCLOUD_APP_KEY,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>serverURL: LEANCLOUD_SERVER_URL</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setIsSdkReady(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("LeanCloud init error:", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>setLoadingMessage("连接服务器失败");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setLoadingMessage("等待 SDK 加载...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, []);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>useEffect(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!isSdkReady) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const initData = async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setLoadingMessage("正在加载数据...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const AV = window.AV;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let serverPoints = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>const pointQuery = new AV.Query('IrrigationPoint');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>pointQuery.limit(1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>serverPoints = await pointQuery.find();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>console.warn("IrrigationPoint class not found, preparing seed data...", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>serverPoints = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let finalPoints = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (serverPoints.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>setLoadingMessage("正在初始化基础数据(首次运行)...");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const newPoints = SEED_POINTS.map(sp =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>const p = new AV.Object('IrrigationPoint');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>p.set('zoneId', sp.zoneId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>p.set('name', sp.name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>return p;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>finalPoints = await AV.Object.saveAll(newPoints);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>} catch (seedError) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>console.error("Failed to seed points:", seedError);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>finalPoints = serverPoints;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const mappedPoints = finalPoints.map(p =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>id: p.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>zoneId: p.get('zoneId'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>name: p.get('name')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setZones(prevZones =&gt; prevZones.map(z =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>...z,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>points: mappedPoints.filter(mp =&gt; mp.zoneId === z.id)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>})));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>let serverRecords = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>const recordQuery = new AV.Query('IrrigationRecord');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>recordQuery.limit(1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>recordQuery.descending('createdAt');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>serverRecords = await recordQuery.find();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} catch (e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>console.warn("IrrigationRecord class not found (likely no records yet).", e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>serverRecords = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const mappedRecords = serverRecords.map(r =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>id: r.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>zoneId: r.get('zoneId'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>pointId: r.get('pointId'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>pointName: r.get('pointName'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>fieldNumber: r.get('fieldNumber'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>date: r.get('date'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>moistureBefore: r.get('moistureBefore'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>moistureAfter: r.get('moistureAfter'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>depth: r.get('depth'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>waterDepthBefore: r.get('waterDepthBefore'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>waterDepthAfter: r.get('waterDepthAfter'),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>volume: r.get('volume')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setRecords(mappedRecords);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsLoading(false);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>console.error("Data Init Critical Error:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setLoadingMessage("数据初始化异常，请刷新重试: " + error.message);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>initData();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, [isSdkReady]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const totalPointsCount = useMemo(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return zones.reduce((total, zone) =&gt; total + zone.points.length, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, [zones]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const sortedRecords = useMemo(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!filterZoneId) return [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const filtered = records.filter(r =&gt; r.zoneId === filterZoneId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return filtered.sort((a, b) =&gt; new Date(b.date) - new Date(a.date));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, [records, filterZoneId]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleZoneClick = (zone) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setFilterZoneId(zone.id);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setExpandedZoneId(expandedZoneId === zone.id ? null : zone.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setSelectedRecordIds([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handlePointClick = (e, zone, point) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (editingPointId === point.id) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setSelectedZone(zone);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setSelectedPoint(point);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setEditingRecordId(null);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setFormData({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>date: new Date().toISOString().split('T')[0],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>fieldNumber: '1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>moistureBefore: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>moistureAfter: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>depth: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>waterDepthBefore: '',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>waterDepthAfter: ''</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setIsModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const startEditPoint = (e, point) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setEditingPointId(point.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setEditNameValue(point.name);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const saveEditPoint = async (e, zoneId, pointId) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const AV = window.AV;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const point = AV.Object.createWithoutData('IrrigationPoint', pointId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>point.set('name', editNameValue);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>await point.save();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setZones(prevZones =&gt; prevZones.map(z =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (z.id === zoneId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>...z,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>points: z.points.map(p =&gt; p.id === pointId ? { ...p, name: editNameValue } : p)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return z;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setEditingPointId(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>alert("保存失败: " + error.message);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const cancelEditPoint = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setEditingPointId(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">          </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleDeletePoint = (e, zoneId, pointId) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteType('point');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setItemToDelete({ zoneId, pointId });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleDeleteRecord = (e, recordId) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (e) e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteType('record');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setItemToDelete({ recordId });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleBatchDelete = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteType('batch_records');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setDeleteModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const executeDelete = async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const AV = window.AV;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (deleteType === 'point' &amp;&amp; itemToDelete) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const point = AV.Object.createWithoutData('IrrigationPoint', itemToDelete.pointId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await point.destroy();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setZones(prevZones =&gt; prevZones.map(z =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>if (z.id === itemToDelete.zoneId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>...z,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>points: z.points.filter(p =&gt; p.id !== itemToDelete.pointId)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return z;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>else if (deleteType === 'record' &amp;&amp; itemToDelete) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const record = AV.Object.createWithoutData('IrrigationRecord', itemToDelete.recordId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await record.destroy();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setRecords(prev =&gt; prev.filter(r =&gt; r.id !== itemToDelete.recordId));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setIsModalOpen(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>else if (deleteType === 'batch_records') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const toDelete = [...selectedRecordIds];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const objectsToDelete = toDelete.map(id =&gt; AV.Object.createWithoutData('IrrigationRecord', id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>await AV.Object.destroyAll(objectsToDelete);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setRecords(prev =&gt; prev.filter(r =&gt; !selectedRecordIds.includes(r.id)));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setSelectedRecordIds([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setDeleteModalOpen(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setItemToDelete(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setDeleteType(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>alert("删除操作失败: " + error.message);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleAddPoint = async (e, zoneId) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const newName = "新增样点灌区";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const AV = window.AV;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const Point = new AV.Object('IrrigationPoint');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>Point.set('zoneId', zoneId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>Point.set('name', newName);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const savedPoint = await Point.save();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const newPointData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>id: savedPoint.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>zoneId: zoneId,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>name: newName</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setZones(prevZones =&gt; prevZones.map(z =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (z.id === zoneId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>...z,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>points: [...z.points, newPointData]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return z;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setEditingPointId(savedPoint.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setEditNameValue(newName);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>alert("新增失败: " + error.message);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleEditInputClick = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleEditRecord = (record) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const zone = zones.find(z =&gt; z.id === record.zoneId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const point = zone?.points.find(p =&gt; p.id === record.pointId) || { id: record.pointId, name: record.pointName };</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (zone) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setSelectedZone(zone);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setSelectedPoint(point);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setEditingRecordId(record.id);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">              </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setFormData({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>date: record.date,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>fieldNumber: record.fieldNumber || '1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>moistureBefore: record.moistureBefore,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>moistureAfter: record.moistureAfter,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>depth: record.depth,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>waterDepthBefore: record.waterDepthBefore,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>waterDepthAfter: record.waterDepthAfter</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setIsModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleInputChange = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const { name, value } = e.target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setFormData(prev =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const newData = { ...prev, [name]: value };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (name === 'waterDepthBefore') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const numValue = parseFloat(value);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (!isNaN(numValue) &amp;&amp; numValue &gt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>newData.moistureBefore = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>newData.moistureAfter = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                   </span>newData.depth = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return newData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleSelectAll = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (selectedRecordIds.length === sortedRecords.length &amp;&amp; sortedRecords.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setSelectedRecordIds([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setSelectedRecordIds(sortedRecords.map(r =&gt; r.id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleSelectRecord = (id) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setSelectedRecordIds(prev =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (prev.includes(id)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return prev.filter(pid =&gt; pid !== id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return [...prev, id];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const calculatedVolume = useMemo(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const after = parseFloat(formData.moistureAfter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const before = parseFloat(formData.moistureBefore);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const depth = parseFloat(formData.depth);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const wAfter = formData.waterDepthAfter ? parseFloat(formData.waterDepthAfter) : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const wBefore = formData.waterDepthBefore ? parseFloat(formData.waterDepthBefore) : 0;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const isSoilParamsValid = !isNaN(after) &amp;&amp; !isNaN(before) &amp;&amp; !isNaN(depth);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (isSoilParamsValid) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const soilPart = ((after - before) * depth) / 15;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const waterPart = (wAfter - wBefore) / 1.5;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const vol = soilPart + waterPart;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return vol &gt; 0 ? vol.toFixed(2) : "0.00";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return "---";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, [formData]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const currentFilterZoneName = useMemo(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!filterZoneId) return null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return zones.find(z =&gt; z.id === filterZoneId)?.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}, [filterZoneId, zones]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleAIAnalysis = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (sortedRecords.length === 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>alert("当前区域暂无数据，无法进行分析");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const totalVol = sortedRecords.reduce((sum, r) =&gt; sum + r.volume, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const avgVol = (totalVol / sortedRecords.length).toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const validMoistureRecords = sortedRecords.filter(r =&gt; r.moistureBefore &amp;&amp; r.moistureAfter);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let avgMoistureDiff = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (validMoistureRecords.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const totalDiff = validMoistureRecords.reduce((sum, r) =&gt; sum + (r.moistureAfter - r.moistureBefore), 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>avgMoistureDiff = (totalDiff / validMoistureRecords.length).toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>let suggestion = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (parseFloat(avgVol) &gt; 50) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>suggestion = "平均灌水量偏高，建议适当减少单次灌溉时长或频率，注意节水。";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else if (parseFloat(avgVol) &lt; 10) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">               </span>suggestion = "平均灌水量较低，请关注作物是否缺水，或检查数据录入是否准确。";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>suggestion = "当前灌溉水量处于合理区间，请继续保持科学灌溉。";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setAiAnalysisResult({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>count: sortedRecords.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>avgVol,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>avgMoistureDiff,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>suggestion</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setAiModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleGeminiGlobalAnalysis = async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setIsGeminiAnalyzing(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>setGeminiGlobalModalOpen(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const zoneSummary = zones.map(zone =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const zoneRecs = records.filter(r =&gt; r.zoneId === zone.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const totalVol = zoneRecs.reduce((sum, r) =&gt; sum + r.volume, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const avgVol = zoneRecs.length &gt; 0 ? (totalVol / zoneRecs.length).toFixed(2) : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>return {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>name: zone.name,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recordCount: zoneRecs.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>avgVolume: avgVol</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const promptText = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>你是一位资深水利农业专家。请根据以下上海市各区灌溉数据进行综合分析：</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>数据JSON: ${JSON.stringify(zoneSummary)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>请生成一份简短的中文分析报告，包含：</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>1. 全市灌溉活跃度分析（基于填报数量）。</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>2. 区域用水量对比（指出哪个区平均灌水量最大/最小）。</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>3. 针对性的节水建议（不超过3条）。</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>格式要求：使用Markdown格式，语气专业且亲切。</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const response = await fetch(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>method: "POST",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>headers: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>"Content-Type": "application/json",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>body: JSON.stringify({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>contents: [{ parts: [{ text: promptText }] }],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>}),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (!response.ok) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>throw new Error(`API Error: ${response.status}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const data = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const analysisText = data.candidates?.[0]?.content?.parts?.[0]?.text || "分析服务暂不可用。";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setGeminiGlobalResult(analysisText);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>console.error("Gemini Error:", error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setGeminiGlobalResult(`**系统提示：** AI分析服务连接超时或未配置。\n\n基于本地数据简报：\n- 当前共有 ${records.length} 条填报记录。\n- 数据覆盖了 ${zones.length} 个行政区。\n- 请检查各区填报进度是否均衡。`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setIsGeminiAnalyzing(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const handleSubmit = async (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (parseFloat(formData.waterDepthBefore) &lt; 0) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (calculatedVolume === "---" || parseFloat(calculatedVolume) &lt;= 0) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const localData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>zoneId: selectedZone.id,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>pointId: selectedPoint.id,<span class="Apple-converted-space">     </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>pointName: selectedPoint.name,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>date: formData.date,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>fieldNumber: parseInt(formData.fieldNumber),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>moistureBefore: parseFloat(formData.moistureBefore),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>moistureAfter: parseFloat(formData.moistureAfter),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>depth: parseFloat(formData.depth),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>waterDepthBefore: formData.waterDepthBefore ? parseFloat(formData.waterDepthBefore) : 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>waterDepthAfter: formData.waterDepthAfter ? parseFloat(formData.waterDepthAfter) : 0,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>volume: parseFloat(calculatedVolume)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const AV = window.AV;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>let recordObj;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (editingRecordId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recordObj = AV.Object.createWithoutData('IrrigationRecord', editingRecordId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recordObj = new AV.Object('IrrigationRecord');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>Object.keys(localData).forEach(key =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>recordObj.set(key, localData[key]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const savedRecord = await recordObj.save();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>const finalRecord = { ...localData, id: savedRecord.id };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>if (editingRecordId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setRecords(prev =&gt; prev.map(item =&gt; item.id === editingRecordId ? finalRecord : item));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>setRecords(prev =&gt; [finalRecord, ...prev]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setFilterZoneId(selectedZone.id);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setIsModalOpen(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>setEditingRecordId(null);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>alert("数据保存失败: " + error.message);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (isLoading) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div className="min-h-screen bg-slate-50 flex flex-col items-center justify-center text-slate-600"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;Loader2 size={48} className="animate-spin text-blue-600 mb-4" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h2 className="text-xl font-bold"&gt;{loadingMessage}&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p className="text-sm mt-2 opacity-70"&gt;正在连接 LeanCloud 数据中心...&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>return (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div className="min-h-screen bg-slate-100/50 font-sans text-slate-900 flex flex-col"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">              </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{/* Header (已应用 z-40 修复遮挡问题) */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;header className="bg-gradient-to-r from-blue-800 via-blue-700 to-cyan-600 text-white shadow-xl sticky top-0 z-40 border-b border-white/10"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="container mx-auto px-6 py-4 flex items-center justify-between"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="flex items-center gap-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="bg-white/10 p-2 rounded-xl backdrop-blur-sm shadow-inner"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;Sprout size={28} className="text-green-300" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;h1 className="text-2xl font-bold tracking-wide text-white drop-shadow-sm"&gt;上海市灌溉数据填报系统&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;p className="text-xs text-blue-100 opacity-80 flex items-center gap-1 font-medium"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Shanghai Irrigation Data Reporting System</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="hidden md:flex items-center gap-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex flex-col items-end"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;div className="text-3xl font-mono font-bold leading-none tracking-wider text-white drop-shadow-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>{currentTime.toLocaleTimeString('zh-CN', { hour12: false })}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;div className="text-xs font-medium opacity-90 mt-1 tracking-widest uppercase text-blue-50"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>{currentTime.toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit', weekday: 'long' })}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className={`flex items-center gap-2 px-3 py-1.5 rounded-full backdrop-blur-md border shadow-inner ${isOnline ? 'bg-green-500/20 border-green-400/30' : 'bg-red-500/20 border-red-400/30'}`}&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>{isOnline ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="relative flex h-2.5 w-2.5"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-green-400 shadow-[0_0_8px_rgba(74,222,128,0.8)]"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="text-xs font-bold text-green-50"&gt;在线&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="inline-flex rounded-full h-2.5 w-2.5 bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.8)]"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="text-xs font-bold text-red-100"&gt;离线&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;main className="flex-grow container mx-auto px-6 py-8 space-y-8"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{/* 区域选择部分 */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;section&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="flex justify-between items-end mb-5"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="flex items-center gap-2 bg-white px-4 py-2 rounded-xl shadow-sm border border-slate-200"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;MapPin className="text-blue-600" size={20} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h2 className="text-lg font-bold text-slate-800"&gt;区域选择与填报&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;span className="text-xs font-bold bg-gradient-to-r from-blue-600 to-cyan-500 text-white px-3 py-1.5 rounded-full shadow-md shadow-blue-200"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>共 {totalPointsCount} 个样点灌区</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>onClick={handleGeminiGlobalAnalysis}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>className="group flex items-center gap-2 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-4 py-2.5 rounded-xl shadow-lg hover:shadow-indigo-200 transition-all transform hover:-translate-y-0.5"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;Bot size={18} className="text-purple-200 group-hover:animate-bounce" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;span className="font-bold text-sm"&gt;综合分析&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6 items-start"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>{zones.map(zone =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>const isExpanded = expandedZoneId === zone.id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>const isSelected = filterZoneId === zone.id;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                      </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>return (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>key={zone.id}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className={`group relative rounded-2xl transition-all duration-300 overflow-hidden ${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>isSelected<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>? 'bg-white ring-2 ring-blue-400 shadow-lg shadow-blue-100 scale-[1.01]'<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>: 'bg-white border border-slate-100 shadow-sm hover:shadow-xl hover:border-blue-200 hover:-translate-y-1'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onClick={() =&gt; handleZoneClick(zone)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className="p-6 cursor-pointer relative z-10 bg-white"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>{isSelected &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;div className="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-[10px] font-bold rounded-bl-xl shadow-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>当前查看</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="flex justify-between items-start mb-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;h3 className={`text-lg font-bold tracking-tight ${isSelected ? 'text-blue-700' : 'text-slate-700 group-hover:text-blue-600'}`}&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>{zone.name}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;div className={`transition-transform duration-300 ${isExpanded ? 'rotate-180' : ''}`}&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>{isExpanded ? &lt;ChevronUp className="text-blue-500" size={20}/&gt; : &lt;ChevronDown className="text-slate-300 group-hover:text-blue-400" size={20}/&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className={`text-xs font-medium inline-block px-2.5 py-1 rounded-md transition-colors ${isSelected ? 'bg-blue-50 text-blue-600' : 'bg-slate-50 text-slate-500 group-hover:bg-blue-50 group-hover:text-blue-500'}`}&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>下辖 {zone.points.length} 个灌区</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className={`bg-slate-50 border-t border-slate-100 transition-all duration-500 ease-in-out overflow-hidden ${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>isExpanded ? 'max-h-80 opacity-100 overflow-y-auto' : 'max-h-0 opacity-0'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="p-3 space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;p className="text-[10px] font-bold text-slate-400 px-2 uppercase tracking-wider"&gt;选择填报对象:&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>{zone.points.length &gt; 0 ? zone.points.map(point =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>const isEditing = editingPointId === point.id;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>return (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;div</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>key={point.id}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onClick={(e) =&gt; !isEditing &amp;&amp; handlePointClick(e, zone, point)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>className={`relative w-full text-left px-3 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2 group/item ${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>isEditing ? 'bg-white ring-2 ring-blue-300 shadow-sm' : 'text-slate-600 hover:bg-white hover:shadow-md hover:text-blue-600 cursor-pointer border border-transparent hover:border-slate-100'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>{isEditing ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>&lt;div className="flex items-center w-full gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>type="text"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>value={editNameValue}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>onChange={(e) =&gt; setEditNameValue(e.target.value)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>onClick={handleEditInputClick}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>autoFocus</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>className="flex-grow bg-transparent outline-none text-slate-800 font-bold border-b-2 border-blue-400 px-1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>onClick={(e) =&gt; saveEditPoint(e, zone.id, point.id)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>className="p-1.5 bg-green-100 text-green-600 rounded-lg hover:bg-green-200"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;Check size={14} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>onClick={cancelEditPoint}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>className="p-1.5 bg-red-100 text-red-600 rounded-lg hover:bg-red-200"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;X size={14} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>&lt;&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div className="w-1.5 h-1.5 rounded-full bg-slate-300 group-hover/item:bg-blue-400 transition-colors"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;span className="flex-grow truncate"&gt;{point.name}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div className="flex items-center opacity-0 group-hover/item:opacity-100 transition-all transform translate-x-2 group-hover/item:translate-x-0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>onClick={(e) =&gt; startEditPoint(e, point)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>className="p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-100 rounded-lg mr-1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;Pencil size={12} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>onClick={(e) =&gt; handleDeletePoint(e, zone.id, point.id)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>className="p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-100 rounded-lg"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;Trash2 size={12} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>}) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div className="text-xs text-slate-400 text-center py-4 bg-slate-100 rounded-lg border border-dashed border-slate-200"&gt;暂无数据&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>)}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                              </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onClick={(e) =&gt; handleAddPoint(e, zone.id)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>className="w-full text-left px-3 py-2.5 rounded-xl text-xs font-bold text-blue-600 hover:bg-blue-50 border border-dashed border-blue-300 hover:border-blue-400 transition-all flex items-center justify-center gap-2 mt-2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;Plus size={14} /&gt; 新增样点灌区</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>})}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/section&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>{/* 历史数据表格部分 (已修复滚动透视和层级问题) */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden h-[650px] flex flex-col relative z-0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="px-6 py-4 border-b-2 border-indigo-100 bg-slate-50 flex justify-between items-center h-16 relative z-20 flex-shrink-0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="bg-white p-1.5 rounded-lg shadow-sm border border-slate-200 text-blue-600"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;History size={18} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;h2 className="font-bold text-slate-700 flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{currentFilterZoneName ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span className="text-slate-400"&gt;当前区域:&lt;/span&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="relative group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;span className="text-blue-700 bg-blue-50 px-3 py-1 rounded border border-blue-100 font-bold"&gt;{currentFilterZoneName}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;div className="absolute -bottom-2 left-0 w-full h-0.5 bg-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>) : '填报记录 (请先选择区域)'}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>onClick={handleAIAnalysis}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>className="group bg-white hover:bg-slate-50 text-slate-600 hover:text-blue-600 px-3 py-1.5 rounded-lg text-xs font-bold border border-slate-200 flex items-center gap-1.5 transition-all"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;BarChart3 size={14} className="text-slate-400 group-hover:text-blue-500" /&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>本区分析</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/button&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>{selectedRecordIds.length &gt; 0 &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>onClick={handleBatchDelete}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>className="animate-in fade-in slide-in-from-right-5 bg-red-50 text-red-600 px-4 py-2 rounded-xl text-xs font-bold border border-red-200 hover:bg-red-100 hover:border-red-300 flex items-center gap-2 transition-all shadow-sm"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;Trash2 size={14} /&gt; 批量删除 ({selectedRecordIds.length})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>)}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;span className="text-xs font-medium text-slate-500 bg-white px-3 py-1.5 rounded-lg border border-slate-200 shadow-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>共 {sortedRecords.length} 条记录</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="absolute bottom-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-indigo-200 to-transparent"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                  </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="overflow-auto flex-grow"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;table className="w-full text-sm text-left border-collapse"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;thead className="text-xs text-slate-500 font-semibold uppercase bg-white border-b border-slate-100 sticky top-0 z-10 shadow-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 w-12 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>{sortedRecords.length &gt; 0 &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;button onClick={handleSelectAll} className="text-slate-400 hover:text-blue-600 transition-colors"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>{selectedRecordIds.length === sortedRecords.length &amp;&amp; sortedRecords.length &gt; 0 ?<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;CheckSquare size={18} className="text-blue-600 drop-shadow-sm"/&gt; :<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;Square size={18} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4"&gt;填报日期&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4"&gt;行政区&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-blue-700"&gt;样点灌区名称&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-center"&gt;典型田块&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right"&gt;灌水前水深&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right"&gt;灌水后水深&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right"&gt;灌前含水率&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right"&gt;灌后含水率&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right"&gt;湿润层深度&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-right text-blue-700 bg-blue-50/30"&gt;本次灌水量&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;th className="px-4 py-4 text-center w-20"&gt;操作&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;tbody className="divide-y divide-slate-100 bg-white"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{sortedRecords.length &gt; 0 ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>sortedRecords.map((record, index) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>const zoneName = zones.find(z =&gt; z.id === record.zoneId)?.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>const isSelected = selectedRecordIds.includes(record.id);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>return (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;tr<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>key={record.id}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onDoubleClick={() =&gt; handleEditRecord(record)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>className={`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>transition-all duration-200 cursor-pointer select-none group</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>${isSelected ? 'bg-blue-50/80' : index % 2 === 0 ? 'bg-white' : 'bg-slate-50/30'}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>hover:bg-blue-50 hover:shadow-sm relative</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-center" onClick={(e) =&gt; e.stopPropagation()}&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;button onClick={() =&gt; handleSelectRecord(record.id)} className="text-slate-400 hover:text-blue-600 transition-colors"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>{isSelected ? &lt;CheckSquare size={18} className="text-blue-600"/&gt; : &lt;Square size={18} /&gt;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 font-mono text-slate-600 text-xs font-medium tracking-wide"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>{record.date}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 font-medium text-slate-600"&gt;{zoneName}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 font-bold text-slate-700 group-hover:text-blue-700 transition-colors"&gt;{record.pointName || '---'}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-center font-mono font-bold text-slate-500 bg-slate-100/50 rounded m-1 inline-block w-8"&gt;{record.fieldNumber}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right text-slate-500 font-mono"&gt;{record.waterDepthBefore} &lt;span className="text-[10px] text-slate-300"&gt;mm&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right text-slate-500 font-mono"&gt;{record.waterDepthAfter} &lt;span className="text-[10px] text-slate-300"&gt;mm&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right text-slate-600 font-mono"&gt;{record.moistureBefore}&lt;span className="text-[10px] text-slate-300"&gt;%&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right text-slate-600 font-mono"&gt;{record.moistureAfter}&lt;span className="text-[10px] text-slate-300"&gt;%&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right text-slate-600 font-mono"&gt;{record.depth} &lt;span className="text-[10px] text-slate-300"&gt;cm&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-right font-bold text-blue-600 bg-blue-50/30 font-mono border-l border-slate-100 group-hover:border-white"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>{record.volume.toFixed(2)} &lt;span className="text-[10px] font-normal text-slate-400"&gt;方/亩&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;td className="px-4 py-4 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onClick={(e) =&gt; handleDeleteRecord(e, record.id)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>className="p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all opacity-0 group-hover:opacity-100"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>title="删除此条记录"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;Trash2 size={16} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td colSpan="12" className="px-6 py-24 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>{filterZoneId ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div className="flex flex-col items-center gap-4 text-slate-400 animate-in fade-in slide-in-from-bottom-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;div className="bg-slate-50 p-4 rounded-full"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;ClipboardEdit size={48} className="text-slate-300" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p className="text-lg font-medium text-slate-500"&gt;该区域暂无填报数据&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p className="text-sm mt-1"&gt;请点击对应区域的展开菜单进行数据录入&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div className="flex flex-col items-center gap-4 text-slate-400 animate-in fade-in slide-in-from-bottom-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;div className="bg-blue-50 p-4 rounded-full animate-bounce"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;LayoutDashboard size={48} className="text-blue-300" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p className="text-lg font-bold text-slate-600"&gt;请选择一个行政区&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p className="text-sm mt-1"&gt;点击上方卡片开始管理与填报数据&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/section&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/main&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{/* 填报对话框 (Modal) */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{isModalOpen &amp;&amp; selectedZone &amp;&amp; selectedPoint &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm transition-all animate-in fade-in duration-200"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden border border-slate-100 transform scale-100"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="px-8 py-6 bg-gradient-to-r from-blue-600 to-blue-500 text-white flex justify-between items-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h3 className="font-bold text-xl flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;ClipboardEdit size={24} className="text-blue-200" /&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>{editingRecordId ? '修改填报数据' : '新增填报数据'}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="flex items-center gap-2 mt-2 text-xs text-blue-100/80"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="bg-white/20 px-2 py-0.5 rounded"&gt;{selectedZone.name}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span&gt;/&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;span className="font-bold text-white"&gt;{selectedPoint.name}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;button onClick={() =&gt; setIsModalOpen(false)} className="p-2 hover:bg-white/20 rounded-full transition-colors"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;X size={24} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;form onSubmit={handleSubmit} className="p-8 space-y-6 bg-slate-50/50"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                      </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="flex gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-2 flex-grow"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;label className="flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>灌水日期</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="relative group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;Calendar size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>type="date"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>name="date"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>value={formData.date}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-white focus:ring-4 focus:ring-blue-100 focus:border-blue-400 outline-none transition-all shadow-sm font-medium text-slate-700"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-2 w-1/3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;label className="flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>典型田块</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;select</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>name="fieldNumber"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>value={formData.fieldNumber}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>className="w-full px-4 py-3 rounded-xl border border-slate-200 bg-white focus:ring-4 focus:ring-blue-100 focus:border-blue-400 outline-none shadow-sm font-bold text-slate-700 appearance-none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;option value="1"&gt;1号田&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;option value="2"&gt;2号田&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>&lt;option value="3"&gt;3号田&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ChevronDown size={16} className="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm space-y-5"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h4 className="text-xs font-bold text-blue-600 uppercase tracking-wider flex items-center gap-2 border-b border-slate-100 pb-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;Ruler size={14} /&gt; 田面水层深度 (mm)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/h4&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="grid grid-cols-2 gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label className="text-sm font-medium text-slate-600"&gt;灌水前&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>type="number"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>name="waterDepthBefore"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>step="1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>placeholder="0"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>value={formData.waterDepthBefore}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>className={`w-full px-4 py-2.5 rounded-xl border bg-slate-50 focus:bg-white outline-none transition-all ${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>formData.waterDepthBefore &amp;&amp; parseFloat(formData.waterDepthBefore) &lt; 0<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>? "border-red-300 focus:ring-4 focus:ring-red-100"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                  </span>: "border-slate-200 focus:border-blue-400 focus:ring-4 focus:ring-blue-50"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                          </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label className="text-sm font-medium text-slate-600"&gt;灌水后&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>type="number"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>name="waterDepthAfter"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>step="1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>placeholder="0"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>value={formData.waterDepthAfter}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                              </span>className="w-full px-4 py-2.5 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white focus:border-blue-400 focus:ring-4 focus:ring-blue-50 outline-none transition-all"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="grid grid-cols-2 gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;label className="text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>灌前含水率 (%)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type="number"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name="moistureBefore"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>step="0.1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>placeholder="0.0"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>value={formData.moistureBefore}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className="w-full px-4 py-3 rounded-xl border border-slate-200 bg-white focus:ring-4 focus:ring-blue-100 focus:border-blue-400 outline-none transition-all shadow-sm"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;label className="text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>灌后含水率 (%)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type="number"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name="moistureAfter"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>step="0.1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>placeholder="0.0"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>value={formData.moistureAfter}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className="w-full px-4 py-3 rounded-xl border border-slate-200 bg-white focus:ring-4 focus:ring-blue-100 focus:border-blue-400 outline-none transition-all shadow-sm"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label className="text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>计划湿润层深度 (cm)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;Layers size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-amber-400" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type="number"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>name="depth"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>placeholder="例如: 40"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>required</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>value={formData.depth}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onChange={handleInputChange}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 bg-white focus:ring-4 focus:ring-amber-100 focus:border-amber-400 outline-none transition-all shadow-sm"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="bg-blue-600 rounded-2xl p-5 text-white shadow-lg shadow-blue-200 relative overflow-hidden group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;Calculator size={80} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="relative z-10"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="text-blue-100 text-xs font-bold uppercase tracking-wider mb-1"&gt;自动计算灌水量&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="flex items-end gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span className="text-4xl font-bold tracking-tight"&gt;{calculatedVolume}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span className="text-sm font-medium opacity-80 mb-1.5"&gt;方/亩&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="flex gap-4 pt-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{editingRecordId &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>type="button"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>onClick={(e) =&gt; handleDeleteRecord(e, editingRecordId)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>className="px-4 py-3 rounded-xl border border-red-200 text-red-500 hover:bg-red-50 font-bold transition-colors flex items-center gap-2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;Trash2 size={20} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>type="button"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>onClick={() =&gt; setIsModalOpen(false)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className="flex-1 px-6 py-3 rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-100 font-bold transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>取消</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>type="submit"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className="flex-[2] px-6 py-3 rounded-xl bg-blue-600 text-white hover:bg-blue-700 font-bold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all flex justify-center items-center gap-2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;Save size={20} /&gt; {editingRecordId ? '更新数据' : '确认保存'}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/form&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>)}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{/* 通用删除确认 Modal */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{deleteModalOpen &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/70 backdrop-blur-md animate-in fade-in"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-white rounded-3xl shadow-2xl max-w-sm w-full p-8 border border-slate-100 transform transition-all scale-100"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div className="flex flex-col items-center text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-6 shadow-inner"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;Trash2 size={32} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;h3 className="text-xl font-bold text-slate-800 mb-3"&gt;确认删除?&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;p className="text-slate-500 text-sm mb-8 leading-relaxed"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{deleteType === 'batch_records'<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>? `您即将删除 ${selectedRecordIds.length} 条记录，此操作无法撤销。`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>: '您确定要删除该数据吗？此操作将永久移除该条记录且无法撤销。'}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;div className="flex w-full gap-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>onClick={() =&gt; setDeleteModalOpen(false)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className="flex-1 px-4 py-3 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 font-bold transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>取消</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>onClick={executeDelete}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className="flex-1 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 font-bold shadow-lg shadow-red-200 transition-all"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>确认删除</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>)}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{/* 局部分析结果 Modal */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{aiModalOpen &amp;&amp; aiAnalysisResult &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="fixed inset-0 z-[70] flex items-center justify-center p-4 bg-indigo-900/60 backdrop-blur-md animate-in fade-in"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden border border-white/20"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;div className="bg-gradient-to-r from-indigo-600 to-purple-600 p-6 text-white flex justify-between items-center shadow-lg relative overflow-hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;div className="absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;h3 className="font-bold text-xl flex items-center gap-2 relative z-10"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;BarChart3 size={24} className="text-white/80" /&gt; 本区数据分析</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;button onClick={() =&gt; setAiModalOpen(false)} className="p-2 hover:bg-white/20 rounded-full transition-colors relative z-10"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;X size={20} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                     </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;div className="p-8 space-y-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="grid grid-cols-2 gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="bg-slate-50 p-4 rounded-2xl text-center border border-slate-100 shadow-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="text-xs font-bold text-slate-400 uppercase mb-2 tracking-wider"&gt;分析样本数&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="text-3xl font-bold text-slate-700"&gt;{aiAnalysisResult.count} &lt;span className="text-xs font-normal text-slate-400"&gt;条&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="bg-blue-50 p-4 rounded-2xl text-center border border-blue-100 shadow-sm"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="text-xs font-bold text-blue-400 uppercase mb-2 tracking-wider"&gt;平均灌水量&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="text-3xl font-bold text-blue-600"&gt;{aiAnalysisResult.avgVol} &lt;span className="text-xs font-normal text-blue-400"&gt;方/亩&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;h4 className="text-sm font-bold text-slate-700 flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="p-1.5 bg-blue-100 rounded-lg text-blue-600"&gt;&lt;Droplets size={16} /&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>土壤墒情变化</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/h4&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="bg-slate-50 p-4 rounded-2xl text-sm text-slate-600 border border-slate-200 leading-relaxed"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>灌溉前后含水率平均提升 &lt;span className="font-bold text-green-600 bg-green-50 px-1 rounded"&gt;+{aiAnalysisResult.avgMoistureDiff}%&lt;/span&gt;。</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;h4 className="text-sm font-bold text-slate-700 flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div className="p-1.5 bg-indigo-100 rounded-lg text-indigo-600"&gt;&lt;BrainCircuit size={16} /&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>智能建议</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/h4&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;div className="bg-gradient-to-br from-indigo-50 to-purple-50 p-5 rounded-2xl text-sm text-indigo-900 border border-indigo-100 leading-relaxed shadow-inner"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>{aiAnalysisResult.suggestion}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>onClick={() =&gt; setAiModalOpen(false)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>className="w-full py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all hover:-translate-y-1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                          </span>知晓</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>)}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{/* Gemini 全局分析 Modal */}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>{geminiGlobalModalOpen &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="fixed inset-0 z-[80] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-lg animate-in fade-in"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden border border-white/20 flex flex-col max-h-[85vh]"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;div className="bg-gradient-to-r from-purple-700 via-indigo-700 to-blue-700 p-6 text-white flex justify-between items-center shadow-lg flex-shrink-0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;h3 className="font-bold text-xl flex items-center gap-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;Bot size={28} className="text-purple-200" /&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>Gemini 综合决策分析</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;button onClick={() =&gt; setGeminiGlobalModalOpen(false)} className="p-2 hover:bg-white/20 rounded-full transition-colors"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;X size={20} /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                     </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;div className="p-8 overflow-y-auto custom-scrollbar"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>{isGeminiAnalyzing ? (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;div className="flex flex-col items-center justify-center py-12 space-y-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;div className="relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div className="w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div className="absolute top-0 left-0 w-16 h-16 flex items-center justify-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>&lt;Sparkles size={20} className="text-indigo-600 animate-pulse" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;div className="text-center space-y-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;h4 className="text-lg font-bold text-slate-700"&gt;Gemini 正在思考中...&lt;/h4&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p className="text-slate-500 text-sm"&gt;正在分析全市 {zones.length} 个区域的历史灌溉数据&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>) : (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;div className="space-y-6 animate-in slide-in-from-bottom-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;div className="prose prose-indigo max-w-none"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div className="bg-slate-50 p-6 rounded-2xl border border-slate-100 leading-relaxed text-slate-700 whitespace-pre-wrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>{geminiGlobalResult}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                           </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;div className="flex justify-end pt-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>onClick={() =&gt; setGeminiGlobalModalOpen(false)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>className="px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg transition-all hover:-translate-y-1"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                               </span>关闭报告</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                       </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>)}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;footer className="bg-white border-t border-slate-200 py-8 mt-auto"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div className="container mx-auto px-4 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;p className="text-sm font-medium text-slate-500"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&amp;copy; 2025 上海市智慧水利数据中心 | 数据填报子系统 V1.0</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                  </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;/footer&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const root = createRoot(document.getElementById('root'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>root.render(&lt;App /&gt;);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
